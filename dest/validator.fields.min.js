/*

   https://github.com/donghanji/plugins

 */

module.declare("validator.fields",function(){function a(a){this.vtype={blank:function(a){return a.length<1||""===a},minLength:function(a,b){return a.length>=b},maxLength:function(a,b){return a.length<=b},email:function(a){var c=b.email;return c.test(a)},equal:function(){return!1}},this.vtext={blankText:"",minLength:"",maxLength:"",emailText:"",equalText:""},a.constructor!==Array&&(a=[].concat(a)),this.rules=a}var b={email:/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/};return a.prototype={_r:function(a,b,c){a=a||{};var d=a.field,e=a.allowBlank,f=a.regex;a.allowOnlyWhitespace||(b=void 0!==b?b+"":"",b=b.trim()),e===!1&&(a.allowBlank="blank"),f&&"function"!=typeof f&&(a.regex=function(a){return e!==!1?""!==a?f.test(a):!0:f.test(a)});for(var g in a)if("field"!==g&&"alias"!==g){var h=a[g],i="function"==typeof h?h:this.vtype[h];if(i="function"==typeof i?i:this.vtype[g],"function"==typeof i){var j=i(b,h),k=a.alias,l="";if(j="blank"!==h||e!==!1&&"blank"!==e?j:!j,l=j?l:a[g+"Text"]||a[h+"Text"]||this.vtext[g+"Text"]||this.vtext[h+"Text"]||"",l=l.replace("{"+g+"}",a[g]),k&&"object"==typeof k&&(l=l.replace("{alias}",k[a.field]||"")),c&&!j)return c(d,l),!1}}return!0},validate:function(a,b,c){a=a||{},c=c||this.rules||[];for(var d=0,e=c.length;e>d;d++){var f=c[d]||{},g=f.field;if(g&&g.constructor===Array){for(var h=0,e=g.length,i=[];e>h;h++){var j=$.extend({},f);j.field=g[h],i.push(j)}if(!this.validate(a,b,i))return!1}else if(!this._r(f,a[g],b))return!1}return!0},custom:function(a){a=a||[],a.constructor!==Array&&(a=[].concat(a));for(var b=0,c=a.length;c>b;b++){var d=a[b];for(var e in d)"function"==typeof d[e]?this.vtype[e]=d[e]:this.vtext[e]=d[e]}}},a});